input_datetime:
  cycle_start:
    name: Pump cycle start time
    has_date: false
    has_time: true
  recirculation:
    name: Recirculation cycle
    has_time: true
    has_date: false
    icon: mdi:timer-outline


input_number:
  capacity_imperial:
    name: Pool capacity (gallons)
    min: 1000
    max: 50000
    step: 1000
    unit_of_measurement: gallons
    icon: mdi:water-pump
  capacity_metric:
    name: Pool capacity (m³)
    min: 5
    max: 100
    unit_of_measurement: m³
    icon: mdi:water-pump
  quality:
    name: Pool quality
    min: 0
    max: 9
    unit_of_measurement: stars
    icon: mdi:star
  turbo:
    name: '% in high speed'
    min: 0
    max: 100
    step: 5
    unit_of_measurement: '%'
    icon: mdi:circle-slice-2


input_boolean:
  turbo:
    name: Dual-speed Pump
    icon: mdi:play-speed
  
  factory_started:
    name: Factory config started
    icon: mdi:auto-fix

# should we use imperial units or metric?
# see issue #1
  imperial:
    name: Imperial units
    icon: mdi:tape-measure
    initial: true

sensor:
  - platform: template
    sensors:
      capacity_uom:
        value_template: >-
          {% if is_state("input_boolean.imperial", "on") -%}
            'gallons'
          {%- else -%}
            'm³'
          {%- endif %}
  - platform: template
    sensors:
      capacity:
        friendly_name: "Pool Capacity"
        entity_id:
        - input_number.capacity_imperial
        - input_number.capacity_metric
        - input_boolean.imperial
        value_template: >-
          {% if is_state("input_boolean.imperial", "on") -%}
            {{ states("input_number.capacity_imperial")|int }}
          {%- else -%}
            {{ states("input_number.capacity_metric")|int }}
          {%- endif %}
        icon_template: mdi:water-pump
        unit_of_measurement: ${entities['sensor.capacity_uom'].state}